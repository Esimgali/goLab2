<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Products</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="Home page.html">–ì–ª–∞–≤–Ω–∞—è</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse ml-2" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
            <a class="nav-link" href="Cart.html"><span id="cart-icon">üõí</span><span id="cart-badge" class="badge">0</span>–ö–æ—Ä–∑–∏–Ω–∞</a>
          </li>
        <li class="nav-item active">
          <a class="nav-link" href="Products.html">–ü—Ä–æ–¥—É–∫—Ç—ã</a>
        </li>
        <li class="nav-item">
          <a id="admin" class="nav-link" href="Administrative.html">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</a>
        </li>
      </ul>
    </div>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
      <ol class="navbar-nav">
        <li class="nav-item">
          <button id="loginBtn" type="button" class="btn" data-toggle="modal" data-target="#loginModal">
            –í–æ–π—Ç–∏
          </button>
          <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="loginModalLabel">–í–æ–π—Ç–∏</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <form id="loginForm">
                    <div class="form-group">
                      <label for="login-email">Email:</label>
                      <input type="email" class="form-control" id="login-email" name="email" required>
                    </div>
                    <div class="form-group">
                      <label for="login-password">–ü–∞—Ä–æ–ª—å:</label>
                      <input type="password" class="form-control" id="login-password" name="password" required>
                    </div>
                    <button type="submit" class="btn btn-info">–í–æ–π—Ç–∏</button>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </li>
        <li class="nav-item">
          <button id="registerBtn" type="button" class="btn" data-toggle="modal" data-target="#registerModal">
            –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
          </button>
          <div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="registerModalLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="registerModalLabel">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                  <h2 class="text-center mb-4 text-dark">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</h2>
                  <form id='registrationForm'>
                    <div class="form-group text-dark">
                        <label for="email">Email:</label>
                        <input type="email" class="form-control" id="email" name="email" required>
                        <div id="emailFeedback" class="invalid-feedback"></div>
                    </div>
                    <div class="form-group text-dark">
                        <label for="username">–ò–º—è:</label>
                        <input type="text" class="form-control" id="username" name="username" required>
                        <div id="usernameFeedback" class="invalid-feedback"></div>
                    </div>
                    <div class="form-group text-dark">
                        <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                        <input type="password" class="form-control" id="password" name="password" required>
                        <div id="passwordFeedback" class="invalid-feedback"></div>
                    </div>
                    <button type="submit" class="btn btn-info">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </form>
                </div>
              </div>
            </div>
          </div>
        </li>
        <li class="nav-item" id="usernameDisplay" style="display: none;">
          <span class="nav-link">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="loggedInUsername"></span>!</span>
        </li>
        <li class="nav-item">
          <button id="logoutBtn" class="btn btn-danger" style="display: none;">Logout</button>
        </li>
      </ol>
    </div>
  </nav>

  <div class="container-fluid mt-2">
    <div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content" style="height: 100%; width: 100%;">
          <div class="modal-header">
            <h5 class="modal-title" id="modalLabel">–£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <img id="modalImage" class="img-fluid" alt="–£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞">
          </div>
        </div>
      </div>
    </div>
    <h5>–§–∏–ª—å—Ç—Ä—ã:</h5>
      <form class="btn" id="filters">
        <select style="width: auto; height: 35px; padding-bottom: 4px;" name="category" id="category">
          <option value="all">–í—Å–µ</option>
          <option value="under100">–î–æ $100</option>
          <option value="100to200">$100 - $200</option>
          <option value="above200">–í—ã—à–µ $200</option>
        </select>
        <button class="btn btn-primary" type="button" onclick="applyFilters()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
      </form>
      <form class="btn" id="search-form">
        <input style="width: auto; height: 35px; padding-bottom: 4px;" type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é" aria-label="Search">
        <button class="btn btn-primary" type="button" onclick="searchProducts()">–ò—Å–∫–∞—Ç—å</button>
      </form>
        <button id="addBtn" class="btn btn-success" data-toggle="modal" data-target="#addProductModal">
          –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä
        </button>
        <div class="modal fade" id="addProductModal" tabindex="-1" role="dialog" aria-labelledby="addProductModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addProductModalLabel">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <form>
                  <div class="form-group">
                    <label for="productName">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:</label>
                    <input type="text" class="form-control" id="productName" required>
                  </div>
                  <div class="form-group">
                    <label for="productImage">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:</label>
                    <input type="file" class="form-control-file" id="productImage" accept="image/*" required>
                  </div>                  
                  <div class="form-group">
                    <label for="productDescription">–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:</label>
                    <textarea class="form-control" id="productDescription" rows="3" required></textarea>
                  </div>
                  <div class="form-group">
                    <label for="productPrice">–¶–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞:</label>
                    <input type="number" class="form-control" id="productPrice" min="0" step="0.01" required>
                  </div>                                  
                  <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                </form>
              </div>
            </div>
          </div>
        </div>
  </div>
  <div class="container mt-4">
    <h1>–ù–∞—à –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –ø—Ä–æ–¥—É–∫—Ç–æ–≤</h1>
    <div class="row">
      <div class="col-md-4">
        <div class="card">
          <img src="product1.jpg" class="card-img-top" alt="Product 1">
          <div class="card-body">
            <h5 class="card-title">Rainbow ball</h5>
            <p>–ú—è—á–∏–∫ —Ä–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω—ã–π</p>
            <p class="card-text">–¶–µ–Ω–∞: $99.99</p>
            <button id="1" class="btn btn-primary" onclick="addToCart(1, 'Rainbow ball', 99.99, 1)">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>    
            <button id="removeProduct" class="btn btn-dark" onclick="removeProduct(this)">–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä</button>        
            <p id="likeCount">Likes: <span id="likes1">0</span></p>
            <button id="likeButton1" class="btn" onclick="increaseLikes1()">
              <i class="fas fa-heart"></i> Like
            </button>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card">
          <img src="product2.jpg" class="card-img-top" alt="Product 2">
          <div class="card-body">
            <h5 class="card-title">Rainbow tumbler-toy</h5>
            <p>–ò–≥—Ä—É—à–∫–∞-–Ω–µ–≤–∞–ª—è—à–∫–∞</p>  
            <p class="card-text">–¶–µ–Ω–∞: $200.99</p>
            <button id="2" class="btn btn-primary" onclick="addToCart(2, 'Rainbow tumbler-toy', 200.99, 1)">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>    
            <button id="removeProduct" class="btn btn-dark" onclick="removeProduct(this)">–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä</button>        
            <p id="likeCount">Likes: <span id="likes2">0</span></p>
            <button id="likeButton2" class="btn" onclick="increaseLikes2()">
              <i class="fas fa-heart"></i> Like
            </button>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card" style="border: 2px solid red; border-radius: 15px;">
          <img src="product3.jpg" style="border: 3px solid red; border-radius: 15px;" class="card-img-top" alt="Random toy">
          <div class="card-body">
            <h5 class="card-title">Random toy</h5>
            <p>–°–ª—É—á–∞–π–Ω–∞—è –∏–≥—Ä—É—à–∫–∞ –∏–∑ –Ω–∞—à–µ–≥–æ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞</p>
            <p class="card-text">–¶–µ–Ω–∞: $120.99</p>
            <div id="actionTimer" style="padding: 10px; margin: 10px auto; border: 3px solid red; border-radius: 15px; text-align: center;">
              <div>–î–æ –∫–æ–Ω—Ü–∞ –∞–∫—Ü–∏–∏ –æ—Å—Ç–∞–ª–æ—Å—å:</div>
              <div id="saleCountdown" style="font-size: 1.5em;"></div>
            </div>
            <button id="3" class="btn btn-primary" onclick="addToCart(3, 'Random Toy', 120.99, 1)">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
            <button id="removeProduct" class="btn btn-dark" onclick="removeProduct(this)">–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä</button>            
            <p id="likeCount">Likes: <span id="likes3">0</span></p>
            <button id="likeButton3" class="btn" onclick="increaseLikes3()">
              <i class="fas fa-heart"></i> Like
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    if(localStorage.getItem('login-email')!=='admin@mail.ru'){
      document.getElementById('addBtn').style.display = 'none';
      document.getElementById('admin').style.display = 'none';
      var removeButtons = document.getElementsByClassName('btn-dark');
      for (var i = 0; i < removeButtons.length; i++) {
        console.log("Button id:", removeButtons[i].id);
        removeButtons[i].style.display = 'none';
      }
    }
  </script>
  <script>
    function toggleLike(productId, likeSpanId) {
      let liked = localStorage.getItem(productId + '_liked') === 'true';
      let likes = JSON.parse(localStorage.getItem(productId)) || 0;

      if (liked) {
        likes = Math.max(0, likes - 1);
        localStorage.setItem(productId + '_liked', 'false');
      } else {
        likes++;
        localStorage.setItem(productId + '_liked', 'true'); 
      }
      localStorage.setItem(productId, JSON.stringify(likes));
      document.getElementById(likeSpanId).textContent = likes;
      setLikeButtonState(likeSpanId);
    }

    document.getElementById('likeButton1').addEventListener('click', function() {
      toggleLike('likes1', 'likes1');
    });

    document.getElementById('likeButton2').addEventListener('click', function() {
      toggleLike('likes2', 'likes2');
    });

    document.getElementById('likeButton3').addEventListener('click', function() {
      toggleLike('likes3', 'likes3');
    });

    document.addEventListener('DOMContentLoaded', function() {
      for (let i = 1; i <= 3; i++) {
        let productId = 'likes' + i;
        let likeSpanId = 'likes' + i;
        let likes = JSON.parse(localStorage.getItem(productId)) || 0;
        document.getElementById(likeSpanId).textContent = likes;
        setLikeButtonState(likeSpanId);
      }
    });


    function applyFilters() {
      var category = document.getElementById('category').value;
      var cards = document.querySelectorAll('.col-md-4');
      cards.forEach(function(card) {
        var priceText = card.querySelector('.card-text').textContent; 
        var price = parseFloat(priceText.replace(/[^0-9.]/g, ''));

        if (category === 'all') {
          card.style.display = 'block'; 
        } else if (category === 'under100' && price < 100) {
          card.style.display = 'block'; 
        } else if (category === '100to200' && price >= 100 && price <= 200) {
          card.style.display = 'block'; 
        } else if (category === 'above200' && price > 200) {
          card.style.display = 'block';
        } else {
          card.style.display = 'none'; 
        }
      });
    }
    function searchProducts() {
      var input, filter, cards, title, i, txtValue;
      input = document.getElementById('search-input');
      filter = input.value.toUpperCase();
      cards = document.getElementsByClassName('card');

      for (i = 0; i < cards.length; i++) {
        title = cards[i].getElementsByClassName("card-title")[0];
        txtValue = title.textContent || title.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) { 
          cards[i].parentNode.style.display = "";
        } else {
          cards[i].parentNode.style.display = "none";
        }
      }
    }

    function updateCartBadge() {
      if(localStorage.getItem('login-email')!=='admin@mail.ru'){
        document.getElementById('addBtn').style.display = 'none';
        document.getElementById('admin').style.display = 'none';
        var removeButtons = document.getElementsByClassName('btn-dark');
        for (var i = 0; i < removeButtons.length; i++) {
          console.log("Button id:", removeButtons[i].id);
          removeButtons[i].style.display = 'none';
        }
      }
      var cart = JSON.parse(localStorage.getItem('cart')) || { items: [], total: 0 };
      var cartBadge = document.getElementById('cart-badge');
      
      if (cartBadge) {
        cartBadge.textContent = cart.items.reduce((total, item) => total + item.quantity, 0);
      }

    }

    function addToCart(id, name, price, quantity) {
      var item = {
        id: id,
        name: name,
        price: price,
        quantity: quantity 
      };

      var cart = JSON.parse(localStorage.getItem('cart')) || {items: [], total: 0};

      var existingItemIndex = cart.items.findIndex(cartItem => cartItem.id === id);

      if (existingItemIndex > -1) {
        cart.items[existingItemIndex].quantity += quantity; 
        cart.total += price * quantity; 
      } else {
        cart.items.push(item); 
        cart.total += price * quantity; 
      }

      localStorage.setItem('cart', JSON.stringify(cart)); 
      
      localStorage.setItem('cartUpdated', 'true');

      updateCartBadge();
    }

    document.addEventListener('DOMContentLoaded', function() {
      updateCartBadge();
    });
  </script>

  <script>
    var countDownDate = new Date("Nov 30, 2023 00:00:00").getTime();
    
    var x = setInterval(function() {
    
      var now = new Date().getTime();
        
      var distance = countDownDate - now;
        
      var days = Math.floor(distance / (1000 * 60 * 60 * 24));
      var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
      var seconds = Math.floor((distance % (1000 * 60)) / 1000);
        
      document.getElementById("saleCountdown").innerHTML = days + "–¥ " + hours + "—á "
      + minutes + "–º " + seconds + "—Å ";
        
      if (distance < 0) {
        clearInterval(x);
        document.getElementById("saleCountdown").innerHTML = "–†–∞—Å–ø—Ä–æ–¥–∞–∂–∞ –∑–∞–∫–æ–Ω—á–∏–ª–∞—Å—å";
      }
      if(localStorage.getItem('login-email')!=='admin@mail.ru'){
        document.getElementById('addBtn').style.display = 'none';
        document.getElementById('admin').style.display = 'none';
        var removeButtons = document.getElementsByClassName('btn-dark');
        for (var i = 0; i < removeButtons.length; i++) {
          console.log("Button id:", removeButtons[i].id);
          removeButtons[i].style.display = 'none';
        }
      }
    }, 1000);
    </script>
</body>
<footer class="bg-dark text-white mt-4">
    <div class="container">
      <div class="row">
        <div class="col-md-6">
          <h4>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h4>
          <p>–ê–¥—Ä–µ—Å: SE-2206</p>
          <p>Email: KrutoySait@gmail.com</p>
          <p>–¢–µ–ª–µ—Ñ–æ–Ω: +7 (777) 777-7777</p>
        </div>
        <div class="col-md-6">
          <h4>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</h4>
          <ul class="list-inline">
            <li class="list-inline-item"><a href="#">Facebook</a></li>
            <li class="list-inline-item"><a href="#">Twitter</a></li>
            <li class="list-inline-item"><a href="#">Instagram</a></li>
          </ul>
        </div>
      </div>
      <hr>
      <div class="row">
        <div class="col-md-12">
          <p class="text-center">&copy; 2023 WEB TECHNOLOGY</p>
        </div>
      </div>
    </div>
  </footer>
</html>

<script>
  function showModal(imageSrc) {
    document.getElementById('modalImage').src = imageSrc;
    $('#myModal').modal('show');
  }

  document.querySelectorAll('.card-img-top').forEach(item => {
    item.addEventListener('click', event => {
      showModal(event.target.src);
    });
  });

  
  function setLikeButtonState(likeSpanId) {
  }
</script>

<style>
  #modalImage {
    width: 300%; 
    height: 300%; 
    object-fit: contain; 
  }
</style>  

  <script>
    document.addEventListener("DOMContentLoaded", function(){
      function validateEmail(email) {
        const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
      }
      document.getElementById('email').addEventListener('input', function(e){
        const emailBox = e.target;
        const emailFeedback = document.getElementById('emailFeedback');
        
        if (!validateEmail(emailBox.value)) {
          emailBox.classList.add('is-invalid');
          emailFeedback.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email';
        } else {
          emailBox.classList.remove('is-invalid');
          emailFeedback.textContent = '';
        }
      });
      function validateUsername(username) {
        return /^[a-zA-Z0-9_]{3,}$/.test(username); 
      }
      function validatePassword(password) {
        return /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z0-9]{8,}$/.test(password);
      }

      $('#registerModal').on('shown.bs.modal', function () {
        document.getElementById('username').classList.remove('is-invalid');
        document.getElementById('password').classList.remove('is-invalid');
        document.getElementById('usernameFeedback').textContent = '';
        document.getElementById('passwordFeedback').textContent = '';
      });
      document.getElementById('username').addEventListener('input', function(e){
        var feedbackElement = document.getElementById('usernameFeedback');
        if (!validateUsername(e.target.value)) {
          feedbackElement.textContent = '–ù–∏–∫–Ω–µ–π–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–Ω–≥–ª–∏–π—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è.';
          e.target.classList.add('is-invalid');
        } else {
          e.target.classList.remove('is-invalid');
          feedbackElement.textContent = '';
        }
      });
    document.getElementById('password').addEventListener('input', function(e){
      var feedbackElement = document.getElementById('passwordFeedback');
      if (!validatePassword(e.target.value)) {
        feedbackElement.textContent = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 8 —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Ö–æ—Ç—å –æ–¥–Ω—É –∑–∞–≥–ª–∞–≤–Ω—É—é, —Å—Ç—Ä–æ—á–Ω—É—é –∞–Ω–≥–ª–∏–π—Å–∫—É—é –±—É–∫–≤—É –∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Ü–∏—Ñ—Ä—É';
        e.target.classList.add('is-invalid');
      } else {
        e.target.classList.remove('is-invalid');
        feedbackElement.textContent = '';
      }
    });

    });

    document.getElementById('loginForm').addEventListener('submit', function(event) {
      event.preventDefault();

      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;

      const usersData = JSON.parse(localStorage.getItem('users')) || [];

      if (email === 'admin@mail.ru' && password === 'Admin123') {
        localStorage.setItem('isLoggedIn', 'true');
        localStorage.setItem('login-email', email);
        window.location.href = "Administrative.html";
      }
      else {
        const user = usersData.find(u => u.email === email && u.password === password);
        if (user) {
          localStorage.setItem('isLoggedIn', 'true');
          localStorage.setItem('login-email', email);
          window.location.href = "Products.html";
        } else {
          alert('Invalid email or password');
        }
      }
    });


    document.addEventListener("DOMContentLoaded", function(){

    function validateEmail(email) {
      const re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      return re.test(String(email).toLowerCase());
    }

    document.getElementById('login-email').addEventListener('input', function(e){
      const emailBox = e.target;
      
      if (!validateEmail(emailBox.value)) {
        emailBox.classList.add('is-invalid');
      } else {
        emailBox.classList.remove('is-invalid');
      }
    });

    document.getElementById('login-password').addEventListener('input', function(e){
      const passwordBox = e.target;

      if (passwordBox.value.length < 8) { 
        passwordBox.classList.add('is-invalid');
      } else {
        passwordBox.classList.remove('is-invalid');
      }
    });
    });
    window.addEventListener('load', function() {
      const isLoggedIn = localStorage.getItem('isLoggedIn'); 
      if (isLoggedIn === 'true') {
        const email = localStorage.getItem('login-email');
        const username = getUsernameByEmail(email);
        document.getElementById('loginBtn').style.display = 'none';
        document.getElementById('registerBtn').style.display = 'none';  
        document.getElementById('logoutBtn').style.display = 'inline-block';
        document.getElementById('usernameDisplay').style.display = 'inline-block';
        document.getElementById('loggedInUsername').textContent = username;
        logoutBtn.addEventListener('click', function() {
          localStorage.removeItem('isLoggedIn');
          localStorage.removeItem('login-email');
          window.location.reload();
        });
      }
    });
    function getUsernameByEmail(email) {
      const usersData = JSON.parse(localStorage.getItem('users')) || [];
      const user = usersData.find(u => u.email === email);
      return user ? user.username : '';
    }
    document.getElementById('registrationForm').addEventListener('submit', function(event) {
      event.preventDefault();

      const email = document.getElementById('email').value;
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;

      const usersData = JSON.parse(localStorage.getItem('users')) || [];

      const isExistingUser = usersData.some(user => user.email === email);

      if (!isExistingUser) {
        const newUser = {
          email: email,
          username: username,
          password: password
        };

        usersData.push(newUser);

        localStorage.setItem('users', JSON.stringify(usersData));

        localStorage.setItem('isLoggedIn', 'true');
        localStorage.setItem('login-email', email);
        window.location.href = "Products.html";
      } else {
        alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω');
      }
    });

    document.addEventListener('DOMContentLoaded', function () {
      const addProductForm = document.querySelector('#addProductModal form');

      addProductForm.addEventListener('submit', function (event) {
        event.preventDefault();
        const productName = document.getElementById('productName').value;
        const productDescription = document.getElementById('productDescription').value;
        const productPrice = document.getElementById('productPrice').value;

        if (!isProductAlreadyAdded(productName)) {
          const newProductCard = createProductCard(productName, productDescription, productPrice);
          const productContainer = document.querySelector('.row');
          productContainer.appendChild(newProductCard);

          saveProductToLocalStorage(productName, productDescription, productPrice);
        } else {
          alert('This product is already added.');
        }

        $('#addProductModal').modal('hide');
      });

      displaySavedProducts();

      function displaySavedProducts() {
        const products = JSON.parse(localStorage.getItem('products')) || [];
        const productContainer = document.querySelector('.row');

        products.forEach(product => {
          const newProductCard = createProductCard(product.name, product.description, product.price);
          productContainer.appendChild(newProductCard);
        });
      }

      function increaseLikes(prodId, likeId){
          let liked = localStorage.getItem(prodId + '_liked') === 'false';
          let likes = JSON.parse(localStorage.getItem(prodId)) || 0;

          if (liked) {
            likes = Math.max(0, likes - 1);
            localStorage.setItem(prodId + '_liked', 'false');
          } else {
            likes++;
            localStorage.setItem(prodId + '_liked', 'true'); 
          }
          localStorage.setItem(prodId, JSON.stringify(likes));
          document.getElementById(likeId).textContent = likes;
          setLikeButtonState(likeId);
        }

      document.getElementById('likeButton').addEventListener('click', function() {
        toggleLike('likes', 'likes');
        });

      function createProductCard(name, description, price) {
        const newProduct = { id: Math.random()*100, name: name, price: price, quantity: 1 };
        console.log(newProduct);
        const card = document.createElement('div');
        card.classList.add('col-md-4');
        const imageSrc = "zxc.jpg"
        const likes = Math.random()*2.2;
        const likeButton = Math.random()*333;

        card.innerHTML = `
          <div class="card">
            <img src="${imageSrc}" class="card-img-top" alt="${name}">
            <div class="card-body">
              <h5 class="card-title">${name}</h5>
              <p>${description}</p>
              <p class="card-text">–¶–µ–Ω–∞: $${price}</p>
              <button class="btn btn-primary" onclick="addToCart(${newProduct.id}, '${newProduct.name}', ${newProduct.price}, ${newProduct.quantity})">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
              <button id="removeProduct" class="btn btn-dark" onclick="removeProduct(this)">–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
              <p id="likeCount">Likes: <span id="likes">0</span></p>
              <button id="likeButton" class="btn" onclick="increaseLikes()">
                <i class="fas fa-heart"></i> Like
              </button>
            </div>
          </div>
        `;

        return card;
      }

      function isProductAlreadyAdded(productName) {
        const products = JSON.parse(localStorage.getItem('products')) || [];
        return products.some(product => product.name === productName);
      }

      function saveProductToLocalStorage(name, description, price) {
        const products = JSON.parse(localStorage.getItem('products')) || [];
        const newProduct = {
          name: name,
          description: description,
          price: price
        };

        products.push(newProduct);

        localStorage.setItem('products', JSON.stringify(products));
      }
    });

    function removeProduct(button) {
      const card = button.closest('.card');
      if (card) {
        var products = JSON.parse(localStorage.products);
        var productName = card.querySelector('.card-title').textContent;
        var indexToRemove = products.findIndex(item => item.name === productName);
        if (indexToRemove !== -1) {
          products.splice(indexToRemove, 1);
          localStorage.products = JSON.stringify(products);
          window.location.reload();
        }
      }
    }
    </script>